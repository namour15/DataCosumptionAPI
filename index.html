<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Air Clear</title>
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

  <div class="menu-btn">
    <i class="fas fa-bars fa-2x"></i>
  </div>
  <div class="header">
    <nav class="titulo">


    </nav>

  </div>
  <div id="map"></div>


  <div class="container">
    <nav class="nav-main">
      <img src="imagenes/logo.png" alt="Air Clear Logo" class="nav-brand">
      <ul class="nav-menu">
        <li><a href="#home">Inicio</a></li>
        <li><a href="#monitoring">Monitoreo</a></li>
        <li><a href="#recommendations">Recomendaciones</a></li>
        <li><a href="#statistics">Estadísticas</a></li>
        <li><a href="#contact">Contacto</a></li>
      </ul>

    </nav>
  </div>

  <div class="container">
    <section id="home">
      <header class="showcase">

        <h2 style="font-size: 40px; margin-top: 30px; color: black;">¿Conoces la calidad del aire de tu colonia?</h2>
        <p style="color: black;">Aquí conocerás la calidad del aire de nuestras sedes principales.
          Descubre cómo mantenemos un ambiente saludable en cada ubicación y toma medidas informadas para tu bienestar.
          ¡Comienza a explorar ahora mismo!</p>

        <img src="imagenes/mapa.png" alt="Imagen superpuesta" class="superpuesta">


        <div class="animated-marker1 tooltip">
          <lord-icon src="https://cdn.lordicon.com/tdtlrbly.json" trigger="hover"
            colors="primary:#121331,secondary:#c71f16" style="width:100px;height:100px;" title="Sensor en Dirección 1">

          </lord-icon>
          <span class="tooltiptext" style="left: 140%; top:20%">UPIITA IPN <br>
            Av Instituto Politécnico Nacional 2580, La Laguna Ticoman, Gustavo A. Madero, 07340 Ciudad de México,
            CDMX</span>
        </div>
        <div class="animated-marker2 tooltip">
          <lord-icon src="https://cdn.lordicon.com/tdtlrbly.json" trigger="hover"
            colors="primary:#121331,secondary:#c71f16" style="width:100px;height:100px;" title="Sensor en Dirección 1">
          </lord-icon>
          <span class="tooltiptext" style="left: -170%;">ESCOM IPN <br> Unidad Profesional Adolfo López Mateos, Av. Juan
            de Dios Bátiz, Nueva Industrial Vallejo, Gustavo A. Madero, 07320 Ciudad de México, CDMX</span>
        </div>

  </div>
  <div class="animated-marker3 tooltip">
    <lord-icon src="https://cdn.lordicon.com/tdtlrbly.json" trigger="hover" colors="primary:#121331,secondary:#c71f16"
      style="width:100px;height:100px;" title="Sensor en Dirección 1">
    </lord-icon>
    <span class="tooltiptext" style="left: 140%; top: -30%;">CDA <br>Belisario Domínguez 22, Centro Histórico de la
      Cdad. de México, Las Ranas, Cuauhtémoc, 06010 Ejido del Centro, CDMX</span>
  </div>

  </header>
  </section>

  <div class="main-container">
    <div class="particle-charts">
    </div>
    
    <div class="description-container">
        <h2>Descripción del origen de las partículas</h2>

        <div class="particle-info">
            <p><strong>PM1:</strong> Estas partículas provienen principalmente de procesos de combustión, como el humo generado por los vehículos, la quema de combustibles fósiles en plantas industriales y las emisiones de calefacción. Al ser tan pequeñas, suelen generarse en fuentes donde hay altas temperaturas.</p>
            <p><strong>PM2.5:</strong> Provienen de fuentes similares a las de las PM1, como los gases de escape de los vehículos, la quema de madera, el humo de fábricas y las chimeneas, así como de reacciones químicas en la atmósfera. También pueden formarse a partir de compuestos como los sulfatos y nitratos.</p>
            <p><strong>PM10:</strong> Las partículas más grandes suelen tener su origen en el polvo levantado por el tráfico, actividades de construcción, erupciones volcánicas, el polen y otras partículas generadas por el movimiento del viento sobre superficies secas.</p>
        </div>

        <h3>Clasificación de calidad del aire</h3>
        <div class="quality-table">
            <table>
                <thead>
                    <tr>
                        <th>Categoría</th>
                        <th>PM1 (µg/m³)</th>
                        <th>PM2.5 (µg/m³)</th>
                        <th>PM10 (µg/m³)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="good">
                        <td>Buena (Verde)</td>
                        <td>0-10</td>
                        <td>0-12</td>
                        <td>0-54</td>
                    </tr>
                    <tr class="acceptable">
                        <td>Aceptable (Amarillo)</td>
                        <td>10-15</td>
                        <td>12.1-35.4</td>
                        <td>55-154</td>
                    </tr>
                    <tr class="regular">
                        <td>Regular (Azul)</td>
                        <td>15-20</td>
                        <td>35.5-55.4</td>
                        <td>155-254</td>
                    </tr>
                    <tr class="bad">
                        <td>Mala (Rojo)</td>
                        <td>&gt; 20</td>
                        <td>&gt; 55.5</td>
                        <td>&gt; 254</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

  <div class="container">
    <section id="monitoring">
      <div class="quality-status-row">
        <div class="quality-status">
          <div class="quality-circle good"></div>
          <span>Buena</span>
        </div>
        <div class="quality-status">
          <div class="quality-circle acceptable"></div>
          <span>Aceptable</span>
        </div>
        <div class="quality-status">
          <div class="quality-circle regular"></div>
          <span>Regular</span>
        </div>
        <div class="quality-status">
          <div class="quality-circle poor"></div>
          <span>Mala</span>
        </div>
      </div>
  </div>


  <div class="container">
    <div class="column">
      <div class="donut-set">
        <div class="general-title">UPIITA</div>
      </div>

      <div class="donut-set">
        <div class="general-title">Partículas</div>
        <div class="donut-container">
          <canvas id="pm1-1"></canvas>
          <div class="donut-label">PM1</div>
        </div>
        <div class="donut-container">
          <canvas id="pm25-1"></canvas>
          <div class="donut-label">PM2.5</div>
        </div>
        <div class="donut-container">
          <canvas id="pm10-1"></canvas>
          <div class="donut-label">PM10</div>
        </div>
      </div>
    </div>
    <div class="column">
      <div class="donut-set">
        <div class="general-title">ESCOM</div>
      </div>
      <div class="donut-set">
        <div class="general-title">Partículas</div>
        <div class="donut-container">
          <canvas id="pm1-2"></canvas>
          <div class="donut-label">PM1</div>
        </div>
        <div class="donut-container">
          <canvas id="pm25-2"></canvas>
          <div class="donut-label">PM2.5</div>
        </div>
        <div class="donut-container">
          <canvas id="pm10-2"></canvas>
          <div class="donut-label">PM10</div>
        </div>
      </div>
    </div>

    <div class="column">
      <div class="donut-set">
        <div class="general-title">CDA</div>

      </div>
      <div class="donut-set">
        <div class="general-title">Partículas</div>
        <div class="donut-container">
          <canvas id="pm1-3"></canvas>
          <div class="donut-label">PM1</div>
        </div>
        <div class="donut-container">
          <canvas id="pm25-3"></canvas>
          <div class="donut-label">PM2.5</div>
        </div>
        <div class="donut-container">
          <canvas id="pm10-3"></canvas>
          <div class="donut-label">PM10</div>
        </div>
      </div>
    </div>

  </div>


  <div class="container">
    <label for="startDate">Fecha de consulta:</label>
    <input type="date" id="Date" name="datemin" min="2024-02-26" max="2024-06-30">
    <button onclick="updateChart()">Consultar</button>
  </div>
  </section>


  
 

  <section id="statistics">
    <div>
      <div class="container">
        <div class="chart-container">
          <div id="chart_div"></div>
          <div class="description-section chart-section">
            <h3>Calidad del Aire Registrada durante los Últimos 6 Meses en UPIITA</h3>
            <p>Esta gráfica presenta la calidad del aire registrada en UPIITA durante un periodo de seis meses. Los
              datos muestran las concentraciones de partículas PM2.5, PM1 y PM10, las cuales se obtuvieron a través de
              mediciones continuas en diferentes momentos. Las fluctuaciones observadas en las mediciones reflejan
              variaciones en la calidad del aire y pueden tener implicaciones significativas para la salud pública y la
              formulación de políticas ambientales en la región.</p>
          </div>
        </div>
      </div>
    </div>
  </section>


  <section>
    <div class="container">
      <div class="container-chart">
        <div class="text-section">
          <div class="description-section2">
            <h3>Calidad del Aire Registrada durante los últimos 6 meses en ESCOM</h3>
            <p>Esta gráfica ilustra la calidad del aire registrada en ESCOM a lo largo de seis meses. Se presentan las
              concentraciones de partículas PM2.5, PM1 y PM10, obtenidas mediante mediciones continuas en diversos
              intervalos de tiempo. Las variaciones observadas en los datos reflejan la calidad del aire en esta
              ubicación específica y son fundamentales para comprender el impacto ambiental y sus posibles efectos en la
              salud pública.

            </p>
          </div>
        </div>
        <div class="chart-section2">
          <div id="chart_div2"></div>
        </div>
      </div>
    </div>

  </section>

  <section>
    <div class="container">
      <div class="chart-container">
        <div class="description-section chart-section">
          <h3>Calidad del Aire Registrada durante los Últimos 6 Meses en CDA</h3>
          <p>Esta gráfica presenta la calidad del aire registrada en el Centro de Desarrollo Aeroespacial (CDA) durante
            un periodo de seis meses. Se muestran las concentraciones de partículas PM2.5, PM1 y PM10, obtenidas a
            partir de mediciones continuas en diferentes momentos. Las fluctuaciones en los datos reflejan la
            variabilidad de la calidad del aire en esta área, proporcionando información valiosa sobre las condiciones
            ambientales y su posible influencia en la salud de los trabajadores y la comunidad circundante.
          </p>
        </div>
        <div id="chart_div3"></div>
      </div>
    </div>

  </section>



  <section id="recommendations">
    <div class="news-cards">
      <div class="container">
        <h2 style="font-size: 40px; margin: 30px;">Recomendaciones según la calidad del aire</h2>
        <div id="recommendation-cards" class="cards-container">
          <div class="card">
            <img src="imagenes/8.png" id="rec1" alt="Recomendación 1">

          </div>
          <div class="card">
            <img src="imagenes/7.png" id="rec2" alt="Recomendación 2">

          </div>
          <div class="card">
            <img src="imagenes/6.png" id="rec3" alt="Recomendación 3">

          </div>
          <div class="card">
            <img src="imagenes/5.png" id="rec4" alt="Recomendación 4">

          </div>
        </div>
      </div>
    </div>


    <section id="contact">
      <div class="footer-links">
        <div class="footer-container">
          <ul>
            <li>
              <a href="#">
                <h3>Contacto</h3>
              </a>
            </li>
            <li>
              <a href="#"> Email: anamoura1600@alumno.ipn.mx</a>
            </li>
            <li>
              <a href="#"> Tel: +52 55 31820036</a>
            </li>
          </ul>
          <ul>
            <li>
              <a href="#">
                <h3>Secciones</h3>
              </a>
            </li>
            <li>
              <a href="#"> Inicio</a>
            </li>
            <li>
              <a href="#monitoring"> Monitoreo</a>
            </li>
            <li>
              <a href="#recommendations"> Recomendaciones</a>
            </li>
            <li>
              <a href="#statistics"> Estadisticas</a>
            </li>
          </ul>
          <ul>
            <li>
              <a href="#">
                <h3>Dirección</h3>
              </a>
            </li>
            <li>
              <a href="#"> Av Instituto Politécnico Nacional 2580, La Laguna Ticoman, Gustavo A. Madero, 07340 Ciudad de
                México, CDMX</a>
            </li>
          </ul>
        </div>
      </div>
      </div>
    </section>
 
    <script src="https://unpkg.com/scrollreveal"></script>
    <script src="main.js"></script>
    <script src="https://cdn.lordicon.com/lordicon.js"></script>
    <script>

      const dataDict = {};
      const data_PM1 = {};
      const data_PM25 = {};
      const data_PM10 = {};
  
      fetch('https://air-clear-api-awarh8gfencebcax.eastus2-01.azurewebsites.net/get_indicators_data', {
        method: 'POST',
        body: JSON.stringify({ "date": "" }),
        headers: {
          'Content-Type': 'application/json'
        }
      })
        .then(response => response.json())
        .then(data => {
          console.log('JSON original recibido:', data);

  
          data.forEach(item => {
            dataDict[item.SOURCE] = {
              "PM1": item.PM1,
              "PM10": item.PM10,
              "PM25": item.PM25
            };
          });

          data_PM1['UPIITA'] = dataDict['[dbo].[M_UPIITA]'].PM1;
          data_PM25['UPIITA'] = dataDict['[dbo].[M_UPIITA]'].PM25;
          data_PM10['UPIITA'] = dataDict['[dbo].[M_UPIITA]'].PM10;

          data_PM1['ESCOM'] = dataDict['[dbo].[M_ESCOM]'].PM1;
          data_PM25['ESCOM'] = dataDict['[dbo].[M_ESCOM]'].PM25;
          data_PM10['ESCOM'] = dataDict['[dbo].[M_ESCOM]'].PM10;

          data_PM1['CDA'] = dataDict['[dbo].[M_CDA]'].PM1;
          data_PM25['CDA'] = dataDict['[dbo].[M_CDA]'].PM25;
          data_PM10['CDA'] = dataDict['[dbo].[M_CDA]'].PM10;

          dibujar(data_PM1, data_PM10, data_PM25);
          aplicarRecomendacion(data_PM1);

          console.log('Hola');
        })
        .catch(error => console.error('Error:', error));
      function getBackgroundColor(pmValue) {

        if (pmValue < 25) {
          return '#5cb85c'; 
        } else if (pmValue >= 25 && pmValue <= 30) {
          return '#f0ad4e'; 
        } else if (pmValue > 30 && pmValue <= 50) {
          return '#5bc0de'; 
        } else {
          return '#d9534f'; 
        }
      }

      function dibujar(data_pm1, data_pm10, data_pm2) {
        const dataPM1 = {
          datasets: [{
            data: [data_pm1['UPIITA'], 100 - data_pm1['UPIITA']], 
            backgroundColor: [getBackgroundColor(data_pm1['UPIITA']), '#d3d3d3']
          }],
          labels: ['PM1', '']
        };

   
        const dataPM25 = {
          datasets: [{
            data: [data_pm2['UPIITA'], 100 - data_pm2['UPIITA']], 
            backgroundColor: [getBackgroundColor(data_pm2['UPIITA']), '#d3d3d3']
          }],
          labels: ['PM2.5', '']
        };

        const dataPM10 = {
          datasets: [{
            data: [data_pm10['UPIITA'], 100 - data_pm10['UPIITA']],
            backgroundColor: [getBackgroundColor(data_pm10['UPIITA']), '#d3d3d3']
          }],
          labels: ['PM10', '']
        };

        const dataPM1_ES = {
          datasets: [{
            data: [data_pm1['ESCOM'], 100 - data_pm1['ESCOM']], 
            backgroundColor: [getBackgroundColor(data_pm1['ESCOM']), '#d3d3d3']
          }],
          labels: ['PM1', '']
        };

        const dataPM25_ES = {
          datasets: [{
            data: [data_pm2['ESCOM'], 100 - data_pm2['ESCOM']], 
            backgroundColor: [getBackgroundColor(data_pm2['ESCOM']), '#d3d3d3']
          }],
          labels: ['PM2.5', '']
        };

        const dataPM10_ES = {
          datasets: [{
            data: [data_pm10['ESCOM'], 100 - data_pm10['ESCOM']],
            backgroundColor: [getBackgroundColor(data_pm10['ESCOM']), '#d3d3d3']
          }],
          labels: ['PM10', '']
        };

        const dataPM1_CDA = {
          datasets: [{
            data: [data_pm1['CDA'], 100 - data_pm1['CDA']], 
            backgroundColor: [getBackgroundColor(data_pm1['CDA']), '#d3d3d3']
          }],
          labels: ['PM1', '']
        };

      
        const dataPM25_CDA = {
          datasets: [{
            data: [data_pm2['CDA'], 100 - data_pm2['CDA']],
            backgroundColor: [getBackgroundColor(data_pm2['CDA']), '#d3d3d3']
          }],
          labels: ['PM2.5', '']
        };

        const dataPM10_CDA = {
          datasets: [{
            data: [data_pm10['CDA'], 100 - data_pm10['CDA']], 
            backgroundColor: [getBackgroundColor(data_pm10['CDA']), '#d3d3d3']
          }],
          labels: ['PM10', '']
        };

       
        const options = {
          cutout: '70%',
          plugins: {
            legend: {
              display: false
            }
          }
        };

        new Chart(document.getElementById('pm1-1'), {
          type: 'doughnut',
          data: dataPM1,
          options: options
        });

        new Chart(document.getElementById('pm25-1'), {
          type: 'doughnut',
          data: dataPM25,
          options: options
        });

        new Chart(document.getElementById('pm10-1'), {
          type: 'doughnut',
          data: dataPM10,
          options: options
        });


        new Chart(document.getElementById('pm1-2'), {
          type: 'doughnut',
          data: dataPM1_ES,
          options: options
        });

        new Chart(document.getElementById('pm25-2'), {
          type: 'doughnut',
          data: dataPM25_ES,
          options: options
        });

        new Chart(document.getElementById('pm10-2'), {
          type: 'doughnut',
          data: dataPM10_ES,
          options: options
        });

        new Chart(document.getElementById('pm1-3'), {
          type: 'doughnut',
          data: dataPM1_CDA,
          options: options
        });

        new Chart(document.getElementById('pm25-3'), {
          type: 'doughnut',
          data: dataPM25_CDA,
          options: options
        });

        new Chart(document.getElementById('pm10-3'), {
          type: 'doughnut',
          data: dataPM10_CDA,
          options: options
        });



        initializeChart('pm1-1', dataPM1, options);
        initializeChart('pm25-1', dataPM25, options);
        initializeChart('pm10-1', dataPM10, options);

        initializeChart('pm1-2', dataPM1_ES, options);
        initializeChart('pm25-2', dataPM25_ES, options);
        initializeChart('pm10-2', dataPM10_ES, options);

        initializeChart('pm1-3', dataPM1_CDA, options);
        initializeChart('pm25-3', dataPM25_CDA, options);
        initializeChart('pm10-3', dataPM10_CDA, options);
      }

      function updateChart() {
        const dataDict = {};
        const data_PM1 = {};
        const data_PM25 = {};
        const data_PM10 = {};
        fetch('https://air-clear-api-awarh8gfencebcax.eastus2-01.azurewebsites.net/get_indicators_data', {
          method: 'POST',
          body: JSON.stringify({ "date": document.getElementById('Date').value }),
          headers: {
            'Content-Type': 'application/json'
          }
        })
          .then(response => response.json())
          .then(data => {
            console.log('JSON original recibido:', data);
            data.forEach(item => {
              dataDict[item.SOURCE] = {
                "PM1": item.PM1,
                "PM10": item.PM10,
                "PM25": item.PM25
              };
            });

            data_PM1['UPIITA'] = dataDict['[dbo].[M_UPIITA]'].PM1;
            data_PM25['UPIITA'] = dataDict['[dbo].[M_UPIITA]'].PM25;
            data_PM10['UPIITA'] = dataDict['[dbo].[M_UPIITA]'].PM10;

            data_PM1['ESCOM'] = dataDict['[dbo].[M_ESCOM]'].PM1;
            data_PM25['ESCOM'] = dataDict['[dbo].[M_ESCOM]'].PM25;
            data_PM10['ESCOM'] = dataDict['[dbo].[M_ESCOM]'].PM10;

            data_PM1['CDA'] = dataDict['[dbo].[M_CDA]'].PM1;
            data_PM25['CDA'] = dataDict['[dbo].[M_CDA]'].PM25;
            data_PM10['CDA'] = dataDict['[dbo].[M_CDA]'].PM10;
            dibujar(data_PM1, data_PM10, data_PM25);
            aplicarRecomendacion(data_PM1);

            console.log('Hola');
          })
          .catch(error => console.error('Error:', error));
        function getBackgroundColor(pmValue) {
          if (pmValue < 25) {
            return '#5cb85c'; 
          } else if (pmValue >= 25 && pmValue <= 30) {
            return '#f0ad4e'; 
          } else if (pmValue > 30 && pmValue <= 50) {
            return '#5bc0de'; 
          } else {
            return '#d9534f'; 
          }
        }

        function dibujar(data_pm1, data_pm10, data_pm2) {
          const dataPM1 = {
            datasets: [{
              data: [data_pm1['UPIITA'], 100 - data_pm1['UPIITA']],
              backgroundColor: [getBackgroundColor(data_pm1['UPIITA']), '#d3d3d3']
            }],
            labels: ['PM1', '']
          };
          const dataPM25 = {
            datasets: [{
              data: [data_pm2['UPIITA'], 100 - data_pm2['UPIITA']],
              backgroundColor: [getBackgroundColor(data_pm2['UPIITA']), '#d3d3d3']
            }],
            labels: ['PM2.5', '']
          };
          const dataPM10 = {
            datasets: [{
              data: [data_pm10['UPIITA'], 100 - data_pm10['UPIITA']], 
              backgroundColor: [getBackgroundColor(data_pm10['UPIITA']), '#d3d3d3']
            }],
            labels: ['PM10', '']
          };
          const dataPM1_ES = {
            datasets: [{
              data: [data_pm1['ESCOM'], 100 - data_pm1['ESCOM']], 
              backgroundColor: [getBackgroundColor(data_pm1['ESCOM']), '#d3d3d3']
            }],
            labels: ['PM1', '']
          };
          const dataPM25_ES = {
            datasets: [{
              data: [data_pm2['ESCOM'], 100 - data_pm2['ESCOM']], 
              backgroundColor: [getBackgroundColor(data_pm2['ESCOM']), '#d3d3d3']
            }],
            labels: ['PM2.5', '']
          };
          const dataPM10_ES = {
            datasets: [{
              data: [data_pm10['ESCOM'], 100 - data_pm10['ESCOM']], 
              backgroundColor: [getBackgroundColor(data_pm10['ESCOM']), '#d3d3d3']
            }],
            labels: ['PM10', '']
          };

          const dataPM1_CDA = {
            datasets: [{
              data: [data_pm1['CDA'], 100 - data_pm1['CDA']], 
              backgroundColor: [getBackgroundColor(data_pm1['CDA']), '#d3d3d3']
            }],
            labels: ['PM1', '']
          };
          const dataPM25_CDA = {
            datasets: [{
              data: [data_pm2['CDA'], 100 - data_pm2['CDA']], 
              backgroundColor: [getBackgroundColor(data_pm2['CDA']), '#d3d3d3']
            }],
            labels: ['PM2.5', '']
          };
          const dataPM10_CDA = {
            datasets: [{
              data: [data_pm10['CDA'], 100 - data_pm10['CDA']], 
              backgroundColor: [getBackgroundColor(data_pm10['CDA']), '#d3d3d3']
            }],
            labels: ['PM10', '']
          };
          const options = {
            cutout: '70%',
            plugins: {
              legend: {
                display: false
              }
            }
          };
          Chart.helpers.each(Chart.instances, function (instance) {
            instance.destroy();
          });
          new Chart(document.getElementById('pm1-1'), {
            type: 'doughnut',
            data: dataPM1,
            options: options
          });
          new Chart(document.getElementById('pm25-1'), {
            type: 'doughnut',
            data: dataPM25,
            options: options
          });
          new Chart(document.getElementById('pm10-1'), {
            type: 'doughnut',
            data: dataPM10,
            options: options
          });
          new Chart(document.getElementById('pm1-2'), {
            type: 'doughnut',
            data: dataPM1_ES,
            options: options
          });
          new Chart(document.getElementById('pm25-2'), {
            type: 'doughnut',
            data: dataPM25_ES,
            options: options
          });
          new Chart(document.getElementById('pm10-2'), {
            type: 'doughnut',
            data: dataPM10_ES,
            options: options
          });
          new Chart(document.getElementById('pm1-3'), {
            type: 'doughnut',
            data: dataPM1_CDA,
            options: options
          });
          new Chart(document.getElementById('pm25-3'), {
            type: 'doughnut',
            data: dataPM25_CDA,
            options: options
          });
          new Chart(document.getElementById('pm10-3'), {
            type: 'doughnut',
            data: dataPM10_CDA,
            options: options
          });
          initializeChart('pm1-1', dataPM1, options);
          initializeChart('pm25-1', dataPM25, options);
          initializeChart('pm10-1', dataPM10, options);

          initializeChart('pm1-2', dataPM1_ES, options);
          initializeChart('pm25-2', dataPM25_ES, options);
          initializeChart('pm10-2', dataPM10_ES, options);

          initializeChart('pm1-3', dataPM1_CDA, options);
          initializeChart('pm25-3', dataPM25_CDA, options);
          initializeChart('pm10-3', dataPM10_CDA, options);
        }
      }
    </script>

    <title>Calidad del Aire en UPIITA</title>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load('current', { 'packages': ['corechart'] });
      google.charts.setOnLoadCallback(drawChart);
      let elements = [];
      function drawChart() {
        fetch('https://air-clear-api-awarh8gfencebcax.eastus2-01.azurewebsites.net/get_historical_data_upiita', {
          method: 'GET',
          headers: {
            'Content-Type': 'application/json'
          }
        })
          .then(response => response.json())
          .then(data => {
            elements = [];
            data.forEach(item => {
              const date = new Date(2024, item.MONTH - 1, 1); 
              elements.push([date, parseFloat(item.PM25), parseFloat(item.PM1), parseFloat(item.PM10)]);
            });
            const dataArray = [['Fecha', 'PM2.5', 'PM1', 'PM10']].concat(elements);
            const dataTable = google.visualization.arrayToDataTable(dataArray);
            const options = {
              title: 'Mediciones en UPIITA',
              curveType: 'function',
              legend: { position: 'top' },
              vAxis: { title: 'µg/m³' },
              hAxis: { title: 'Fecha' },
              pointSize: 3
            };
            const chart = new google.visualization.LineChart(document.getElementById('chart_div'));
            chart.draw(dataTable, options);
          })
          .catch(error => console.error('Error:', error));
      }
    </script>


    <title>Calidad del Aire en ESCOM</title>
    <script type="text/javascript">
      google.charts.load('current', { 'packages': ['corechart'] });
      google.charts.setOnLoadCallback(drawChart);

      function drawChart() {
        fetch('https://air-clear-api-awarh8gfencebcax.eastus2-01.azurewebsites.net/get_historical_data_escom', {
          method: 'GET',
          headers: {
            'Content-Type': 'application/json'
          }
        })
          .then(response => response.json())
          .then(data => {
            elements = [];
            data.forEach(item => {
              const date = new Date(2024, item.MONTH - 1, 1); 
              elements.push([date, parseFloat(item.PM25), parseFloat(item.PM1), parseFloat(item.PM10)]);
            });
            const dataArray = [['Fecha', 'PM2.5', 'PM1', 'PM10']].concat(elements);
            const dataTable = google.visualization.arrayToDataTable(dataArray);
            const options = {
              title: 'Mediciones en ESCOM',
              curveType: 'function',
              legend: { position: 'top' },
              vAxis: { title: 'µg/m³' },
              hAxis: { title: 'Fecha' },
              pointSize: 3
            };
            const chart = new google.visualization.LineChart(document.getElementById('chart_div2'));
            chart.draw(dataTable, options);
          })
          .catch(error => console.error('Error:', error));
      }
    </script>
    </script>


    <title>Calidad del Aire en CDA</title>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load('current', { 'packages': ['corechart'] });
      google.charts.setOnLoadCallback(drawChart);

      function drawChart() {
        fetch('https://air-clear-api-awarh8gfencebcax.eastus2-01.azurewebsites.net/get_historical_data_cda', {
          method: 'GET',
          headers: {
            'Content-Type': 'application/json'
          }
        })
          .then(response => response.json())
          .then(data => {
            elements = [];
            data.forEach(item => {
              const date = new Date(2024, item.MONTH - 1, 1); 
              elements.push([date, parseFloat(item.PM25), parseFloat(item.PM1), parseFloat(item.PM10)]);
            });
            const dataArray = [['Fecha', 'PM2.5', 'PM1', 'PM10']].concat(elements);
            const dataTable = google.visualization.arrayToDataTable(dataArray);
            const options = {
              title: 'Mediciones en CDA',
              curveType: 'function',
              legend: { position: 'top' },
              vAxis: { title: 'µg/m³' },
              hAxis: { title: 'Fecha' },
              pointSize: 3
            };
            const chart = new google.visualization.LineChart(document.getElementById('chart_div3'));
            chart.draw(dataTable, options);
          })
          .catch(error => console.error('Error:', error));
      }

      function aplicarRecomendacion(data_PM1) {
        const cards = document.querySelectorAll('.card');
        cards.forEach(card => card.classList.remove('highlight'));
        let cardId = '';
        if (pmValue < 25) {
          cardId = 'rec1'; 
        } else if (pmValue >= 25 && pmValue <= 30) {
          cardId = 'rec2'; 
        } else if (pmValue > 30 && pmValue <= 50) {
          cardId = 'rec3'; 
        } else {
          cardId = 'rec4'; 
        }
        document.getElementById(cardId).classList.add('highlight');
      }

    </script>
    </script>


</body>


</html>